@model Crunchers.Controllers.AdminController.ProductResponse
<div id="LoadingImage" style="display:none;background-color: rgb(255, 255, 255); opacity: 0.7; width: 100%; height: 100%; position: absolute; top: 0px; left: 0px; z-index: 99999;">
    <img style="display: block;margin-left: auto;margin-right: auto" src="https://igc-market.ru/images/loading.gif"/>
</div>
<script>
    let urlParams = new URLSearchParams(window.location.search);
    function AddProduct() {
       var values = [];
       var characteristicNodes = document.getElementById('newCharacteristics').getElementsByTagName('input');
       var i;
       for (i = 0; i < characteristicNodes.length; i++) {
         values.push(characteristicNodes[i].value);
       }
        
        let imageLink = document.getElementById("productImageInput").value;
        let productName = document.getElementById("productNameInput").value;
        let productPrice = document.getElementById("productPriceInput").value;
        let categoryId=urlParams.get('categoryId');
        $("#LoadingImage").show();
       $.ajax({
                type: "POST",
                url: '@Url.RouteUrl(new {controller = "Admin", action = "AddProduct"})?imageLink='+imageLink+'&productName='+productName+'&productPrice='+productPrice+'&categoryId='+categoryId,
                data: JSON.stringify(values),
                dataType: 'json',
                timeout: 15000,
                success: function (data) {
                    $("#LoadingImage").hide();
                    alert('Товар успешно добавлен');
                    location.reload();     
                },
                error: function(inc) {
                    $("#LoadingImage").hide();
                    alert('Произошла ошибка');
                    location.reload(); 
                }
            });
    }
</script>
<form>
    <form>
        <input id="productImageInput" placeholder="Вставьте ссылку на изображение"/>
        <input id="productNameInput" placeholder="Введите название товара"/>
        <input id="productPriceInput" placeholder="Введите цену товара"/>
    </form>
    <br/>
    <div id="newCharacteristics">
        @foreach (var characteristic in Model.Characteristics)
        {
            <label>@characteristic.CharacteristicName:</label>
            if (characteristic.CharacteristicType == "Строковое значение")
            {
                <input id="Name=@characteristic.CharacteristicId" placeholder="Введите строковое значение для характеристики"/>
            }
            else
            {
                <input id="Name=@characteristic.CharacteristicId" placeholder="Введите числовое значение для характеристики"/>
                if (characteristic.Unit != null || characteristic.Unit != "")
                {
                    <text>(в @(characteristic.Unit))(0 в случае отсутствия)</text>
                }
            }
            <br/>
        }
    </div>
    <a onclick=" AddProduct()">Add Product</a>
</form>
<hr/>
@{    
    var products = Model.Products.ToList();
    var characteristics = Model.Characteristics.ToList();
    for (var i = 0; i < products.Count; i++)
    {
        for (var j = 0; j < characteristics.Count; j++)
        {
            
        }
    }
    
}